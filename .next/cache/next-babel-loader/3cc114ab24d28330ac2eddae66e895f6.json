{"ast":null,"code":"const bcrypt = require('bcryptjs');\n\nconst User = require('../../../models/User');\n\nexport default ((req, res) => {\n  if (req.method === 'POST') {\n    User.findOne({\n      email: req.body.email\n    }).then(user => {\n      if (user) {\n        // Throw a 400 error if the email address already exists\n        return res.status(400).json({\n          email: \"A user has already registered with this address\"\n        });\n      } else {\n        // Otherwise create a new user\n        const newUser = new User({\n          accountType: req.body.accountType,\n          email: req.body.email,\n          password: req.body.password\n        });\n        bcrypt.genSalt(10, (err, salt) => {\n          bcrypt.hash(newUser.password, salt, (err, hash) => {\n            if (err) throw err;\n            newUser.password = hash;\n            newUser.save().then(user => res.json(user)).catch(err => {\n              console.log(err);\n              res.json({\n                error: err\n              });\n            });\n          });\n        });\n      }\n    });\n    return;\n  }\n\n  res.json({\n    awww: 'yeahhh'\n  });\n});","map":null,"metadata":{},"sourceType":"module"}